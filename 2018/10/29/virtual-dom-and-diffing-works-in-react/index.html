<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="React," />










<meta name="description" content="åŸæ–‡æ¥è‡ªï¼šhttps://medium.com/@gethylgeorge/how-virtual-dom-and-diffing-works-in-react-6fc805f9f84eå°½ç®¡ï¼Œæˆ‘ä»¬å¤§æ¦‚çŸ¥é“reactä¸­çš„virtual DOMæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œä½†æ˜¯æˆ‘ä¸€ç›´è§†å›¾å»ç†è§£å®ƒçš„å·¥ä½œuæ¡ˆä¾‹ã€‚å¹¶ä¸”å°è¯•è§£é‡Šçš„æ›´æ¸…æ¥šã€‚åˆšå¼€å§‹ï¼Œæˆ‘åšäº†å¾ˆå¤šè°ƒç ”ï¼Œä½†æ˜¯éƒ½æ²¡æ³•ç­‰åˆ°æˆ‘æƒ³è¦çš„ç­”æ¡ˆã€‚æœ€åï¼Œæˆ‘å†³å®šé˜…è¯»reactå’Œreac">
<meta name="keywords" content="React">
<meta property="og:type" content="article">
<meta property="og:title" content="Reactä¸­çš„Virtual DOMå’Œdiffå·¥ä½œåŸç†">
<meta property="og:url" content="http://yoursite.com/2018/10/29/virtual-dom-and-diffing-works-in-react/index.html">
<meta property="og:site_name" content="ç‰›ç‰›æ˜¯åªğŸ±">
<meta property="og:description" content="åŸæ–‡æ¥è‡ªï¼šhttps://medium.com/@gethylgeorge/how-virtual-dom-and-diffing-works-in-react-6fc805f9f84eå°½ç®¡ï¼Œæˆ‘ä»¬å¤§æ¦‚çŸ¥é“reactä¸­çš„virtual DOMæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œä½†æ˜¯æˆ‘ä¸€ç›´è§†å›¾å»ç†è§£å®ƒçš„å·¥ä½œuæ¡ˆä¾‹ã€‚å¹¶ä¸”å°è¯•è§£é‡Šçš„æ›´æ¸…æ¥šã€‚åˆšå¼€å§‹ï¼Œæˆ‘åšäº†å¾ˆå¤šè°ƒç ”ï¼Œä½†æ˜¯éƒ½æ²¡æ³•ç­‰åˆ°æˆ‘æƒ³è¦çš„ç­”æ¡ˆã€‚æœ€åï¼Œæˆ‘å†³å®šé˜…è¯»reactå’Œreac">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://yoursite.com/2018/10/29/virtual-dom-and-diffing-works-in-react/1_iJKfCo2XlFtz-9ST0_HCtA.png">
<meta property="og:image" content="http://yoursite.com/2018/10/29/virtual-dom-and-diffing-works-in-react/1_ZrzXoRljG5Co5KvEsWJNjA.png">
<meta property="og:image" content="http://yoursite.com/2018/10/29/virtual-dom-and-diffing-works-in-react/1_QX2kUf7GoCkTNkTWBUfX-g.png">
<meta property="og:image" content="http://yoursite.com/2018/10/29/virtual-dom-and-diffing-works-in-react/1_UeJO46kqBIm0Z8j9B8G6kw.png">
<meta property="og:image" content="http://yoursite.com/2018/10/29/virtual-dom-and-diffing-works-in-react/1_WMkI8W__gUagZEVCUN37Pg.png">
<meta property="og:image" content="http://yoursite.com/2018/10/29/virtual-dom-and-diffing-works-in-react/1_SBXiC6G3cjT5deW1tR0C4w.png">
<meta property="og:image" content="http://yoursite.com/2018/10/29/virtual-dom-and-diffing-works-in-react/1_HmOs3RG_uYsneZFHnrmYEA.png">
<meta property="og:image" content="http://yoursite.com/2018/10/29/virtual-dom-and-diffing-works-in-react/1_UVixYuczWFlNJ7tbM4TAsg.png">
<meta property="og:image" content="http://yoursite.com/2018/10/29/virtual-dom-and-diffing-works-in-react/1_9paXIsNMjkuN4iBdpJ-MXg.png">
<meta property="og:image" content="http://yoursite.com/2018/10/29/virtual-dom-and-diffing-works-in-react/1_chzMjpfd821rcHntjWb8rQ.png">
<meta property="og:image" content="http://yoursite.com/2018/10/29/virtual-dom-and-diffing-works-in-react/1_l2w9vcsBN7wd2UqZ7qZTHA.png">
<meta property="og:image" content="http://yoursite.com/2018/10/29/virtual-dom-and-diffing-works-in-react/1_-N2b8UJgqIUtgUfPLWtQQw.png">
<meta property="og:image" content="http://yoursite.com/2018/10/29/virtual-dom-and-diffing-works-in-react/1_xvjOyXVne-7Y0ch0dRTIdw.png">
<meta property="og:updated_time" content="2018-10-29T09:42:22.611Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Reactä¸­çš„Virtual DOMå’Œdiffå·¥ä½œåŸç†">
<meta name="twitter:description" content="åŸæ–‡æ¥è‡ªï¼šhttps://medium.com/@gethylgeorge/how-virtual-dom-and-diffing-works-in-react-6fc805f9f84eå°½ç®¡ï¼Œæˆ‘ä»¬å¤§æ¦‚çŸ¥é“reactä¸­çš„virtual DOMæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œä½†æ˜¯æˆ‘ä¸€ç›´è§†å›¾å»ç†è§£å®ƒçš„å·¥ä½œuæ¡ˆä¾‹ã€‚å¹¶ä¸”å°è¯•è§£é‡Šçš„æ›´æ¸…æ¥šã€‚åˆšå¼€å§‹ï¼Œæˆ‘åšäº†å¾ˆå¤šè°ƒç ”ï¼Œä½†æ˜¯éƒ½æ²¡æ³•ç­‰åˆ°æˆ‘æƒ³è¦çš„ç­”æ¡ˆã€‚æœ€åï¼Œæˆ‘å†³å®šé˜…è¯»reactå’Œreac">
<meta name="twitter:image" content="http://yoursite.com/2018/10/29/virtual-dom-and-diffing-works-in-react/1_iJKfCo2XlFtz-9ST0_HCtA.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2018/10/29/virtual-dom-and-diffing-works-in-react/"/>





  <title>Reactä¸­çš„Virtual DOMå’Œdiffå·¥ä½œåŸç† | ç‰›ç‰›æ˜¯åªğŸ±</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">ç‰›ç‰›æ˜¯åªğŸ±</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-åˆ†ç±»">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            åˆ†ç±»
          </a>
        </li>
      
        
        <li class="menu-item menu-item-æ–‡ç« ">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            æ–‡ç« 
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/10/29/virtual-dom-and-diffing-works-in-react/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="luby xu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ç‰›ç‰›æ˜¯åªğŸ±">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Reactä¸­çš„Virtual DOMå’Œdiffå·¥ä½œåŸç†</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-10-29T17:42:22+08:00">
                2018-10-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Reactæºç åˆ†æ/" itemprop="url" rel="index">
                    <span itemprop="name">Reactæºç åˆ†æ</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>åŸæ–‡æ¥è‡ªï¼š<a href="https://medium.com/@gethylgeorge/how-virtual-dom-and-diffing-works-in-react-6fc805f9f84e" target="_blank" rel="noopener">https://medium.com/@gethylgeorge/how-virtual-dom-and-diffing-works-in-react-6fc805f9f84e</a><br><img src="/2018/10/29/virtual-dom-and-diffing-works-in-react/1_iJKfCo2XlFtz-9ST0_HCtA.png"><br>å°½ç®¡ï¼Œæˆ‘ä»¬å¤§æ¦‚çŸ¥é“reactä¸­çš„virtual DOMæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œä½†æ˜¯æˆ‘ä¸€ç›´è§†å›¾å»ç†è§£å®ƒçš„å·¥ä½œuæ¡ˆä¾‹ã€‚å¹¶ä¸”å°è¯•è§£é‡Šçš„æ›´æ¸…æ¥šã€‚<br>åˆšå¼€å§‹ï¼Œæˆ‘åšäº†å¾ˆå¤šè°ƒç ”ï¼Œä½†æ˜¯éƒ½æ²¡æ³•ç­‰åˆ°æˆ‘æƒ³è¦çš„ç­”æ¡ˆã€‚æœ€åï¼Œæˆ‘å†³å®šé˜…è¯»reactå’Œreact-domæºç ï¼Œè¿™æ ·ï¼Œæˆ‘å°±å¯ä»¥å¯¹å·¥ä½œåŸç†æœ‰æ›´å¥½çš„äº†è§£ã€‚<br><a id="more"></a></p>
<blockquote>
<p>åœ¨æˆ‘ä»¬é˜…è¯»ä¹‹å‰ï¼Œä½ æœ‰æ²¡æœ‰æƒ³è¿‡ï¼šä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸ç›´æ¥å°†æ”¹å˜ç›´æ¥æ¸²æŸ“åˆ°DOMä¸Šå‘¢ï¼Ÿ</p>
</blockquote>
<p>ä¸‹ä¸€èŠ‚å°†ä¼šæ¦‚æ‹¬DOMæ˜¯å¦‚ä½•è¢«åˆ›å»ºã€‚å¹¶ä¸”ä¼šè§£é‡Šä¸ºä»€ä¹ˆReactä¼šåœ¨ä¸€å¼€å§‹åˆ›å»ºVirtual DOMã€‚</p>
<h1 id="DOMçš„æ„å»º"><a href="#DOMçš„æ„å»º" class="headerlink" title="DOMçš„æ„å»º"></a>DOMçš„æ„å»º</h1><img src="/2018/10/29/virtual-dom-and-diffing-works-in-react/1_ZrzXoRljG5Co5KvEsWJNjA.png" title="From Mozillaâ€Šâ€”â€Šhttps://developer.mozilla.org/en-US/docs/Introduction_to_Layout_in_Mozilla">
<p>è¿™é‡Œï¼Œæˆ‘ä¸ä¼šæƒ³è¯¦ç»†å»è¯´DOMæ˜¯å¦‚æœåˆ›å»ºçš„ï¼Œå¹¶ä¸”å¦‚ä½•ç»˜åˆ¶åˆ°å±å¹•ä¸Šã€‚ä½†æ˜¯è¯·ä½ é˜…è¯»ä¸‹<a href="https://developer.mozilla.org/en-US/docs/Mozilla/Introduction_to_Layout_in_Mozilla" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a>å’Œ<a href="http://taligarsiel.com/Projects/howbrowserswork1.htm#Parsing_general" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a>äº†è§£ä¸‹æµè§ˆå™¨æ˜¯å¦‚ä½•å°†HTMLè½¬åŒ–æˆDOMèŠ‚ç‚¹ç»˜åˆ¶åˆ°å±å¹•ä¸Šçš„å…¨éƒ¨è¿‡ç¨‹ã€‚</p>
<p>å¯¹äºæ¯ä¸€æ¬¡DOMçš„æ”¹å˜ï¼Œç”±äºDOMæ˜¯ä»£è¡¨ä¸€ä¸ªæ ‘çš„ç»“æ„ã€‚å¯¹DOMçš„æ”¹å˜ä¼šéå¸¸å¿«ï¼Œä½†æ˜¯å¯¹æ”¹å˜ä½œç”¨åœ¨å…ƒç´ ä¸Šå’Œå…ƒç´ çš„å­èŠ‚ç‚¹æ—¶ï¼Œä¼šç»å†<strong>Reflow/Layout</strong>é˜¶æ®µï¼Œç„¶åè¿™äº›æ”¹å˜ä¼šè¢«é‡æ–°<strong>Re-painted</strong>åˆ°å±å¹•ä¸Šï¼Œè¿™ä¸€ä¸ªè¿‡ç¨‹æ˜¯éå¸¸æ…¢çš„ã€‚å› æ­¤ï¼Œ<strong>Reflow/Layout</strong>çš„èŠ‚ç‚¹è¶Šå¤šï¼Œä½ çš„appå°±ä¼šå˜å¾—è¶Šæ…¢ã€‚</p>
<p><strong>Virtual-DOMçœŸæ­£è¦åšçš„ï¼Œå°±æ˜¯å°½åŠ›å»è½»é‡åŒ–è¿™ä¸¤ä¸ªé˜¶æ®µï¼ˆReflow/Layoutå’ŒRe-paintedï¼‰ï¼Œè¿™æ ·å¯¹äºå¤æ‚çš„appï¼Œä¹Ÿä¼šæœ‰è¾ƒå¥½çš„æ€§èƒ½ã€‚</strong></p>
<p>ä¸‹ä¸€èŠ‚å°†ä¼šè¯¦ç»†è§£é‡ŠVirtual DOMæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p>
<h1 id="ç†è§£Virtual-DOM"><a href="#ç†è§£Virtual-DOM" class="headerlink" title="ç†è§£Virtual DOM"></a>ç†è§£Virtual DOM</h1><p>ç°åœ¨ï¼Œäº†è§£äº†DOMçš„æ„å»ºä¹‹åï¼Œè®©æˆ‘ä»¬å¼€å§‹çœ‹çœ‹Virtual DOMã€‚ç°åœ¨ï¼Œæˆ‘å°†ä¼šåˆ©ç”¨ä¸€ä¸ªappçš„æ —å­æ¥è§£é‡ŠVirtual DOMçš„å·¥ä½œæ–¹å¼ã€‚è¿™æ ·æ–¹ä¾¿ä½ å°±ä¼šæœ‰ä¸€ä¸ªç›´è§‚çš„äº†è§£ã€‚</p>
<blockquote>
<p>åœ¨è¿™é‡Œï¼Œæˆ‘ä¸ä¼šå»è§£é‡Šç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶å‘ç”Ÿäº†ä»€ä¹ˆäº‹ï¼Œè€Œæ˜¯ç€é‡è¯´ä¸‹é‡å¤æ¸²æŸ“ä¼šå‘ç”Ÿä»€ä¹ˆã€‚è¿™æ ·ä¼šå¸®åŠ©ä½ äº†è§£Virtual DOMå’Œdiffå·¥ä½œæœºåˆ¶ã€‚ä¸€æ—¦ä½ æ¸…æ¥šäº†è¿™ä¸ªï¼Œåˆå§‹åŒ–è¿‡ç¨‹å°†ä¼šå˜å¾—å¾ˆæ¸…æ™°ã€‚</p>
</blockquote>
<p>å®ä¾‹ä»£ç å¯ä»¥ä»è¿™é‡Œè·å–ï¼š<a href="https://github.com/Gethyl/UnderstandingReactVirtual" target="_blank" rel="noopener">UnderstandingReactVirtualDOM</a>ï¼Œä¸‹å›¾æ˜¯demoã€‚<br><img src="/2018/10/29/virtual-dom-and-diffing-works-in-react/1_QX2kUf7GoCkTNkTWBUfX-g.png">ã€‚gitåº“ä¸­çš„ä»£ç ï¼Œé™¤äº†<code>Main.js</code>å’Œ<code>Calculator.js</code>ï¼Œå…¶å®ƒéƒ½æ˜¯ä¸é‡è¦çš„ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Calculator.js</span></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">"react"</span></span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">"react-dom"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Calculator</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">		<span class="keyword">super</span>(props);</span><br><span class="line">		<span class="keyword">this</span>.state = &#123;<span class="attr">output</span>: <span class="string">""</span>&#125;;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	render()&#123;</span><br><span class="line">		<span class="keyword">let</span> IntegerA,IntegerB,IntegerC;</span><br><span class="line">		</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span>(</span><br><span class="line">			&lt;div className=<span class="string">"container"</span>&gt;						</span><br><span class="line">				&lt;h2&gt;using React&lt;<span class="regexp">/h2&gt;</span></span><br><span class="line"><span class="regexp">				&lt;div&gt;Input 1: </span></span><br><span class="line"><span class="regexp">					&lt;input type="text" placeholder="Input 1" ref="input1"&gt;&lt;/i</span>nput&gt;</span><br><span class="line">				&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">				&lt;div&gt;Input 2 :</span></span><br><span class="line"><span class="regexp">					&lt;input type="text" placeholder="Input 2" ref="input2"&gt;&lt;/i</span>nput&gt;</span><br><span class="line">				&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">				&lt;div&gt;</span></span><br><span class="line"><span class="regexp">					&lt;button id="add" onClick=&#123; () =&gt; &#123;</span></span><br><span class="line"><span class="regexp">						IntegerA = parseInt(ReactDOM.findDOMNode(this.refs.input1).value)</span></span><br><span class="line"><span class="regexp">						IntegerB = parseInt(ReactDOM.findDOMNode(this.refs.input2).value)</span></span><br><span class="line"><span class="regexp">						IntegerC = IntegerA+IntegerB</span></span><br><span class="line"><span class="regexp">						this.setState(&#123;output:IntegerC&#125;)</span></span><br><span class="line"><span class="regexp">					  &#125;</span></span><br><span class="line"><span class="regexp">					&#125;&gt;Add&lt;/</span>button&gt;</span><br><span class="line">					</span><br><span class="line">					&lt;button id=<span class="string">"subtract"</span> onClick=&#123; () =&gt; &#123;</span><br><span class="line">						IntegerA = <span class="built_in">parseInt</span>(ReactDOM.findDOMNode(<span class="keyword">this</span>.refs.input1).value)</span><br><span class="line">						IntegerB = <span class="built_in">parseInt</span>(ReactDOM.findDOMNode(<span class="keyword">this</span>.refs.input2).value)</span><br><span class="line">						IntegerC = IntegerA-IntegerB</span><br><span class="line">						<span class="keyword">this</span>.setState(&#123;<span class="attr">output</span>:IntegerC&#125;)</span><br><span class="line"></span><br><span class="line">					  &#125;</span><br><span class="line">					&#125;&gt;Subtract&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">				&lt;/</span>div&gt;</span><br><span class="line">				&lt;div&gt;</span><br><span class="line">					&lt;hr/&gt;</span><br><span class="line">					&lt;h2&gt;Output: &#123;<span class="keyword">this</span>.state.output&#125;&lt;<span class="regexp">/h2&gt;</span></span><br><span class="line"><span class="regexp">				&lt;/</span>div&gt;</span><br><span class="line">				</span><br><span class="line">			&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">		);</span></span><br><span class="line"><span class="regexp">	&#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Main.js </span></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">"react"</span>;</span><br><span class="line"><span class="keyword">import</span> Calculator <span class="keyword">from</span> <span class="string">"./Calculator"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Layout</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;</span><br><span class="line">	render()&#123;	</span><br><span class="line">		<span class="keyword">return</span>(</span><br><span class="line">			&lt;div&gt;</span><br><span class="line">			  &lt;h1&gt;Basic Calculator&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">				&lt;Calculator/</span>&gt;</span><br><span class="line">			&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">		);</span></span><br><span class="line"><span class="regexp">	&#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<p>ä¸‹å›¾æ˜¯åˆå§‹åŒ–ä¹‹åçš„DOMèŠ‚ç‚¹ï¼š<br><img src="/2018/10/29/virtual-dom-and-diffing-works-in-react/1_UeJO46kqBIm0Z8j9B8G6kw.png"><br>ä¸‹å›¾æ˜¯å¯¹åº”ä¸Šå›¾DOMèŠ‚ç‚¹ï¼ŒReactæ„å»ºçš„ç»„ä»¶æ ‘ï¼š<br><img src="/2018/10/29/virtual-dom-and-diffing-works-in-react/1_WMkI8W__gUagZEVCUN37Pg.png"></p>
<h2 id="è¾“å…¥input1å’Œinput2ï¼Œç‚¹å‡»addæŒ‰é’®"><a href="#è¾“å…¥input1å’Œinput2ï¼Œç‚¹å‡»addæŒ‰é’®" class="headerlink" title="è¾“å…¥input1å’Œinput2ï¼Œç‚¹å‡»addæŒ‰é’®"></a>è¾“å…¥input1å’Œinput2ï¼Œç‚¹å‡»addæŒ‰é’®</h2><p>ä¸ºäº†äº†è§£Virtual DOMåˆ°DOMè¿‡ç¨‹ä¸­ï¼Œdiffå·¥ä½œå’Œå’Œè§£å·¥ä½œæ–¹å¼ã€‚åœ¨æ —å­ä¸­ï¼Œæˆ‘ä»¬åˆ†åˆ«ç»™inputè¾“å…¥100å’Œ50ï¼Œç‚¹å‡»addæŒ‰é’®ã€‚éšåï¼Œé¢„æœŸä¸­çš„outputæ˜¯150<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Input 1: 100</span><br><span class="line">Input 2: 50</span><br><span class="line"></span><br><span class="line">Output : 150</span><br></pre></td></tr></table></figure></p>
<h2 id="ç‚¹å‡»addæŒ‰é’®ä¹‹åå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ"><a href="#ç‚¹å‡»addæŒ‰é’®ä¹‹åå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ" class="headerlink" title="ç‚¹å‡»addæŒ‰é’®ä¹‹åå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ"></a>ç‚¹å‡»addæŒ‰é’®ä¹‹åå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</h2><p>åœ¨æˆ‘ä»¬æ¡ˆä¾‹ä¸­ï¼Œç‚¹å‡»addæŒ‰é’®å¼ï¼Œæˆ‘ä»¬ä¼šç»™stateè®¾ç½®ä¸€ä¸ªæ–°çš„outputå€¼ï¼š150ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Calculator.js</span></span><br><span class="line">&lt;button id=<span class="string">"add"</span> onClick=&#123; () =&gt; &#123;</span><br><span class="line">      IntegerA = <span class="built_in">parseInt</span>(ReactDOM.findDOMNode(<span class="keyword">this</span>.refs.input1).value)</span><br><span class="line">      IntegerB = <span class="built_in">parseInt</span>(ReactDOM.findDOMNode(<span class="keyword">this</span>.refs.input2).value)</span><br><span class="line">      IntegerC = IntegerA+IntegerB</span><br><span class="line">      <span class="keyword">this</span>.setState(&#123;<span class="attr">output</span>:IntegerC&#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&gt;Add&lt;<span class="regexp">/button&gt;</span></span><br></pre></td></tr></table></figure></p>
<h2 id="æ ‡æ³¨è„ç»„ä»¶"><a href="#æ ‡æ³¨è„ç»„ä»¶" class="headerlink" title="æ ‡æ³¨è„ç»„ä»¶"></a>æ ‡æ³¨è„ç»„ä»¶</h2><img src="/2018/10/29/virtual-dom-and-diffing-works-in-react/1_SBXiC6G3cjT5deW1tR0C4w.png">
<p>ç¬¬ä¸€æ­¥ï¼šç»„ä»¶å¦‚ä½•æ ‡è®°ä¸ºè„ç»„ä»¶ã€‚</p>
<ol>
<li>æ‰€æœ‰çœŸå®DOMäº‹ä»¶ï¼Œéƒ½åŒ…è£¹åœ¨Reactè‡ªå®šä¹‰çš„ç›‘å¬äº‹ä»¶ä¹‹å†…ã€‚å› æ­¤ï¼Œç‚¹å‡»addæŒ‰é’®ä¹‹åï¼Œå°±ä¼šæŠŠè¿™ä¸ªäº‹ä»¶å‘é€ç»™Reactäº‹ä»¶ç›‘å¬ï¼Œç„¶åæ‰§è¡Œä¸Šé¢å†™çš„åŒ¿åå‡½æ•°ã€‚</li>
<li>åœ¨ä¸Šé¢è¿™ä¸ªåŒ¿åå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬è°ƒç”¨<code>this.setState()</code>èµ‹å€¼ä¸€ä¸ªæ–°çš„å€¼ã€‚</li>
<li><code>setState()</code>éšåï¼Œåè¿‡æ¥ä¼šå°†è¿™ä¸ªç»„ä»¶ï¼Œæ ‡è®°ä¸ºè„ç»„ä»¶ã€‚å¦‚ä¸‹ä»£ç ï¼š<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ReactUpdates.js  - enqueueUpdate(component) function</span></span><br><span class="line">dirtyComponents.push(component);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<blockquote>
<p>å¦‚æœä½ å¥‡æ€ªï¼Œä¸ºä»€ä¹ˆReactæ²¡æœ‰å°†buttonæ ‡è®°ä¸ºè„ç»„ä»¶ï¼Œè€Œæ˜¯å°†è¿™ä¸ª<code>Calculator</code>æ ‡è®°æˆè„ç»„ä»¶ï¼Ÿè¿™æ˜¯å› ä¸ºï¼Œå½“ä½ è°ƒç”¨<code>this.setState()</code>çš„æ—¶å€™ï¼Œè¿™æ—¶çš„<code>this</code>æŒ‡çš„æ˜¯<code>Calculator</code>è¿™ä¸ªç»„ä»¶ã€‚</p>
</blockquote>
<ol start="4">
<li>è¿™æ ·ä¸€æ¥ï¼Œ<code>Calculator</code>å°±è¢«æ ‡è®°æˆè„ç»„ä»¶ã€‚è®©æˆ‘ä»¬çœ‹çœ‹æ¥ä¸‹æ¥ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</li>
</ol>
<h2 id="éå†ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ"><a href="#éå†ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="éå†ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ"></a>éå†ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ</h2><p>ç°åœ¨<code>Calculator</code>è¢«æ ‡è®°æˆäº†è„ç»„ä»¶ï¼é‚£æ¥ä¸‹æ¥æ˜¯è¦åšä»€ä¹ˆå‘¢ï¼Ÿæ¥ä¸‹æ¥å°±æ˜¯æ›´æ–°Virtual-DOMï¼Œç„¶ååˆ©ç”¨diffç®—æ³•åšå’Œè§£ï¼Œæœ€åæ›´æ–°åˆ°çœŸæ˜¯çš„DOMä¸Šã€‚</p>
<blockquote>
<p>åœ¨æˆ‘ä»¬è¿›å…¥æ¥ä¸‹æ¥çš„æ­¥éª¤å‰ï¼Œæˆ‘ä»¬éå¸¸æœ‰å¿…è¦ç†Ÿæ‚‰<a href="https://reactjs.org/docs/react-component.html" target="_blank" rel="noopener">ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ</a>ã€‚</p>
</blockquote>
<p>ä¸‹å›¾æ˜¯<code>Calculator</code>ç»„ä»¶ï¼Œåœ¨Ractä¸­çš„ç»“æ„ï¼š<br><img src="/2018/10/29/virtual-dom-and-diffing-works-in-react/1_HmOs3RG_uYsneZFHnrmYEA.png" title="Calculator Wrapper"></p>
<p>æ¥ä¸‹æ¥æ›´æ–°ç»„ä»¶ï¼š</p>
<ol>
<li>è¿™ä¸ªæ›´æ–°æ˜¯ç”±Reactçš„æ‰¹é‡æ›´æ–°å®Œæˆçš„ã€‚</li>
<li><p>åœ¨è¿™ä¸ªæ‰¹é‡æ›´æ–°ä¸­ï¼Œä»–ä¼šæ£€æŸ¥è¿™ä¸ªdirtyComponentsé˜Ÿåˆ—æ˜¯å¦å­˜åœ¨è„ç»„ä»¶ï¼Œç„¶åå¼€å§‹æ›´æ–°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ReactUpdates.js</span></span><br><span class="line"><span class="keyword">var</span> flushBatchedUpdates = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">while</span> (dirtyComponents.length || asapEnqueued) &#123;</span><br><span class="line">    <span class="keyword">if</span> (dirtyComponents.length) &#123;</span><br><span class="line">      <span class="keyword">var</span> transaction = ReactUpdatesFlushTransaction.getPooled();</span><br><span class="line">      transaction.perform(runBatchedUpdates, <span class="literal">null</span>, transaction);</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ¥ä¸‹æ¥ï¼ŒReactä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨éœ€è¦æ›´æ–°çš„<code>pending state</code>ï¼Œæˆ–è€…å­˜åœ¨<code>forceUpdate</code>ã€‚å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">this</span>._pendingStateQueue !== <span class="literal">null</span> || <span class="keyword">this</span>._pendingForceUpdate) &#123;</span><br><span class="line">      <span class="keyword">this</span>.updateComponent(transaction, <span class="keyword">this</span>._currentElement, <span class="keyword">this</span>._currentElement, <span class="keyword">this</span>._context, <span class="keyword">this</span>._context);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>åœ¨æˆ‘ä»¬çš„æ —å­ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œåœ¨calculator wrapperé‡Œï¼Œ<code>this._pendingStateQueue</code>ä¿å­˜äº†ä¸€ä¸ªæœ€æ–°çš„çŠ¶æ€ã€‚<br><img src="/2018/10/29/virtual-dom-and-diffing-works-in-react/1_UVixYuczWFlNJ7tbM4TAsg.png"></p>
<ol start="4">
<li>é¦–å…ˆï¼Œä»–ä¼šæ£€æŸ¥ç»„ä»¶æ˜¯å¦è°ƒç”¨<code>componentWillReceiveProps()</code>ï¼Œå¦‚æœè°ƒç”¨ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨æ–°çš„propså†æ¬¡æ›´æ–°stateã€‚</li>
<li><p>æ¥ä¸‹æ¥ï¼ŒReactä¼šæ£€æŸ¥ç»„ä»¶æ˜¯å¦è°ƒç”¨<code>shouldComponentUpdate()</code>ï¼Œå¦‚æœè°ƒç”¨ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä¸»åŠ¨åˆ¤æ–­è¿™ä¸ªç»„ä»¶æ˜¯å¦éœ€è¦é‡æ–°renderã€‚</p>
<blockquote>
<p>åœ¨ä¸€äº›å·²çŸ¥çš„åœºæ™¯ä¸­ï¼Œä½ å¯ä»¥åˆ©ç”¨è¿™ä¸ªå»é˜»æ­¢ä¸€äº›æ²¡æœ‰å¿…è¦çš„renderï¼Œä»è€Œæé«˜appçš„æ€§èƒ½ã€‚</p>
</blockquote>
</li>
<li><p>æ¥ä¸‹æ¥<code>componentWillUpdate()</code>ï¼Œ<code>render()</code>ï¼Œ<code>componentDidUpdate()</code>ä¼šæŒ‰é¡ºåºè°ƒç”¨ã€‚</p>
</li>
<li>ç°åœ¨ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹åœ¨<code>render()</code>ä¸­å‘ç”Ÿäº†ä»€ä¹ˆã€‚<blockquote>
<p>renderæ˜¯Virtual DOMé‡æ–°æ„å»ºï¼Œå’Œdiffç®—æ³•å‘ç”Ÿçš„åœ°æ–¹</p>
</blockquote>
</li>
</ol>
<h2 id="renderç»„ä»¶â€”â€”æ›´æ–°Virtual-DOMï¼Œè°ƒç”¨diffç®—æ³•ï¼Œæœ€åæ›´æ–°åˆ°DOMä¸­ã€‚"><a href="#renderç»„ä»¶â€”â€”æ›´æ–°Virtual-DOMï¼Œè°ƒç”¨diffç®—æ³•ï¼Œæœ€åæ›´æ–°åˆ°DOMä¸­ã€‚" class="headerlink" title="renderç»„ä»¶â€”â€”æ›´æ–°Virtual-DOMï¼Œè°ƒç”¨diffç®—æ³•ï¼Œæœ€åæ›´æ–°åˆ°DOMä¸­ã€‚"></a>renderç»„ä»¶â€”â€”æ›´æ–°Virtual-DOMï¼Œè°ƒç”¨diffç®—æ³•ï¼Œæœ€åæ›´æ–°åˆ°DOMä¸­ã€‚</h2><p>åœ¨æˆ‘ä»¬çš„æ —å­ä¸­ï¼Œ<code>Calculator</code>ç»„ä»¶å†…çš„æ‰€æœ‰å…ƒç´ ä¼šå†ä¸€æ¬¡åœ¨Virtual DOMé‡Œæ„å»ºï¼š<br><img src="/2018/10/29/virtual-dom-and-diffing-works-in-react/1_9paXIsNMjkuN4iBdpJ-MXg.png"><br>Reactä¼šæ£€ä¹‹å‰çš„renderçš„Reactå…ƒç´ å’Œrenderä¹‹åçš„Reactå…ƒç´ æ˜¯ä¸æ˜¯ä¸€ä¸ªtypeå’Œä¸€ä¸ªkeyã€‚ç„¶åå¯¹ç»„ä»¶ã€typeå’Œkeyåè°ƒåŒ¹é…ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> prevRenderedElement = <span class="keyword">this</span>._renderedComponent._currentElement;</span><br><span class="line"><span class="keyword">var</span> nextRenderedElement = <span class="keyword">this</span>._instance.render(); <span class="comment">//Calculator.render() method is called and the element is build.</span></span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>æ³¨æ„ï¼šè¿™ä¸ªåœ°æ–¹æ˜¯è°ƒç”¨ç»„ä»¶renderçš„åœ°æ–¹ã€‚åœ¨è¿™ä¸ªæ —å­ä¸­å°±æ˜¯ï¼š<code>Calculator.render()</code></p>
</blockquote>
<p>æ•´ä¸ªå’Œè§£é˜¶æ®µå¯ä»¥é€šè¿‡å¦‚ä¸‹æ­¥éª¤ï¼š<br><img src="/2018/10/29/virtual-dom-and-diffing-works-in-react/1_chzMjpfd821rcHntjWb8rQ.png" title="Component render()â€Šâ€”â€Šupdating the Virtual DOM, running the diffing algorithm and finally updating the DOM"></p>
<blockquote>
<p>å›¾ä¸­ï¼Œçº¢è‰²çš„ç‚¹çº¿è¡¨ç¤ºæ‰€æœ‰çš„è¿™äº›æ­¥éª¤ä¼šåœ¨ä¸‹ä¸€ä¸ªå­èŠ‚ç‚¹ï¼Œå­èŠ‚ç‚¹ä¸­çš„å­èŠ‚ç‚¹é€’å½’è°ƒç”¨ã€‚</p>
</blockquote>
<p>ä¸Šå›¾æ¦‚æ‹¬äº†ï¼ŒVirtual DOMæ˜¯å¦‚ä½•å°†æ›´æ–°åº”ç”¨åˆ°DOMèŠ‚ç‚¹ä¸Šçš„ã€‚ï¼ˆå›¾ä¸­ï¼Œæˆ‘å¿½ç•¥äº†ä¸€äº›å·²çŸ¥çš„æˆ–ä¸çŸ¥çš„æ­¥éª¤ï¼Œä½†å›¾è¡¨æ¦‚æ‹¬äº†å¤§å¤šæ•°çš„æ ¸å¿ƒæ­¥éª¤ï¼‰</p>
<p><em>å› æ­¤ï¼Œä½ å¯ä»¥çŸ¥é“ï¼Œåœ¨æˆ‘ä»¬çš„æ —å­ä¸­ï¼Œå’Œè§£é˜¶æ®µæ˜¯å¦‚ä½•è¿›è¡Œçš„ã€‚</em>æˆ‘ä¼šå¼•é¢†ä½ ï¼Œå°†DOMæ›´æ–°ä¸ºOutputï¼š150ã€‚å¹¶è·³è¿‡ä¸€äº›divçš„å’Œè§£é˜¶æ®µã€‚<br><img src="/2018/10/29/virtual-dom-and-diffing-works-in-react/1_l2w9vcsBN7wd2UqZ7qZTHA.png"></p>
<ul>
<li>å’Œè§£é˜¶æ®µä»å…¥å£ç»„ä»¶çš„divå¼€å§‹ï¼Œä¹Ÿå°±æ˜¯<code>class=â€container</code>çš„é‚£ä¸ªç»„ä»¶ï¼ˆAï¼‰ã€‚</li>
<li>Aä¸­æœ‰ä¸€ä¸ªæ‹¥æœ‰<em>Output</em>çš„divï¼ˆBï¼‰ï¼Œå› æ­¤reactä¼šå’Œè§£è¿™ä¸ªç»„ä»¶çš„å­èŠ‚ç‚¹ã€‚</li>
<li>åœ¨Bä¸­ï¼Œä»–æœ‰ä¸¤ä¸ªå­©å­ï¼š<code>&lt;hr&gt;</code> å’Œ <code>&lt;h2&gt;</code>ã€‚</li>
<li>Reactä¼šä»<code>&lt;hr&gt;</code>å¼€å§‹å’Œè§£ã€‚</li>
<li>åœ¨å¯¹<code>&lt;h2&gt;</code>å¼€å§‹å’Œè§£ï¼Œç”±äº<code>&lt;h2&gt;</code>æœ‰ä¸¤ä¸ªå­©å­ï¼šä¸€ä¸ªæ˜¯æ–‡æœ¬ã€Outputã€ï¼Œå¦ä¸€ä¸ªæ˜¯æ¥è‡ªstateçš„outputå€¼ã€‚å› æ­¤ï¼ŒReactä¼šåˆ†åˆ«å¯¹è¿™ä¸¤ä¸ªå­©å­è¿›è¡Œå’Œè§£ã€‚</li>
<li>å¯¹äºç¬¬ä¸€ä¸ªæ–‡æœ¬Outputï¼Œæ–‡æœ¬ç»è¿‡è°ƒè§£ï¼Œå‘ç°å¹¶æ²¡æœ‰å˜åŒ–ã€‚å› æ­¤ä¸å¯¹DOMåšä»»ä½•æ“ä½œã€‚</li>
<li>å¯¹äºæ¥è‡ªstateçš„ouputå€¼ï¼Œç»è¿‡è°ƒè§£åï¼Œå‘ç°outputæœ‰ä¸€ä¸ªæ–°çš„å€¼ï¼ˆ150ï¼‰ï¼ŒReactå°†ä¼šæ›´æ–°çœŸå®DOMã€‚</li>
</ul>
<h2 id="æ¸²æŸ“çœŸå®DOM"><a href="#æ¸²æŸ“çœŸå®DOM" class="headerlink" title="æ¸²æŸ“çœŸå®DOM"></a>æ¸²æŸ“çœŸå®DOM</h2><p>æ —å­ä¸­ï¼Œåœ¨è°ƒè§£è¿‡ç¨‹ï¼Œåªæœ‰Outputé‡æ–°ç»˜åˆ¶ï¼š<br><img src="/2018/10/29/virtual-dom-and-diffing-works-in-react/1_-N2b8UJgqIUtgUfPLWtQQw.png"><br>ç»„ä»¶æ ‘æ›´æ–°å¦‚ä¸‹ï¼š<br><img src="/2018/10/29/virtual-dom-and-diffing-works-in-react/1_xvjOyXVne-7Y0ch0dRTIdw.png"></p>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>å°½ç®¡è¿™ä¸ªæ —å­éå¸¸ä¸é‡è¦ï¼Œä½†ä¼šç»™ä½ ä¸€ä¸ªå…³äºReactä¸­å‘ç”Ÿäº†ä»€ä¹ˆçš„åº•å±‚è®¤çŸ¥ã€‚</p>
<blockquote>
<p>æˆ‘å¹¶ä¸ä¼šç”¨ä¸€ä¸ªéå¸¸å¤æ‚çš„åº”ç”¨è§£é‡Šï¼Œå› ä¸ºè¿™æ ·ç”»ç»„ä»¶æ ‘ä¼šå˜å¾—éå¸¸å›°éš¾ä¸”æ²¡æœ‰æ„ä¹‰</p>
</blockquote>
<p>Reactçš„å’Œè§£é˜¶æ®µå¦‚ä¸‹ï¼š</p>
<ul>
<li>å¯¹æ¯”æ¸²æŸ“ä¹‹å‰çš„å®ä¾‹å’Œæ¸²æŸ“ä¹‹åçš„å®ä¾‹ã€‚</li>
<li>æ›´æ–°åœ¨ç»„ä»¶æ ‘ä¸­çš„å®ä¾‹ï¼ˆVirtual DOMï¼‰ã€‚</li>
<li>ä»…åœ¨å­˜åœ¨å®é™…å˜åŒ–çš„èŠ‚ç‚¹åŠå…¶å­èŠ‚ç‚¹ä¸Šï¼Œæ›´æ–°çœŸå®DOMã€‚</li>
</ul>
<h1 id="ç‰›ç‰›ç†è§£"><a href="#ç‰›ç‰›ç†è§£" class="headerlink" title="ç‰›ç‰›ç†è§£"></a>ç‰›ç‰›ç†è§£</h1><p>æœ¬æ–‡å‘è¡¨äº2017å¹´çš„1æœˆä»½ï¼Œé’ˆå¯¹çš„æ˜¯å½“æ—¶çš„Reactï¼Œåº”è¯¥æ˜¯React15ï¼Œå› æ­¤ç›¸å…³çš„é“¾æ¥å¯èƒ½æœ‰è¯¯ï¼Œä¸”è¯´åˆ°çš„ç”Ÿå‘½å‘¨æœŸå±äºåŸå…ˆçš„ç”Ÿå‘½å‘¨æœŸã€‚</p>
<p>ä½†æ˜¯ï¼Œæ–‡ç« æ•´ä¸ªdiffæµç¨‹ï¼Œç”¨äº†ä¸€ä¸ªå¾ˆç®€æ´çš„æ —å­ã€‚æè¿°æ¸…æ¥šï¼Œä¸”å¯¹æœªæ¥é˜…è¯»React16ä¹Ÿæœ‰å¾ˆå¤§å¸®åŠ©ã€‚</p>
<p>é˜…è¯»ä¹‹å‰ï¼Œå§‹ç»ˆä¸ç†è§£Reactä¸­çš„reconciliationä¸ºä»€ä¹ˆä¼šç¿»è¯‘æˆï¼šå’Œè§£ï¼Ÿä»æ–‡ä¸­æ¥çœ‹ï¼Œå‡ºç°reconciliationè¿™ä¸ªå•è¯çš„æ—¶å€™ï¼Œéƒ½ä¼šä¼´éšç€previouså’Œnextã€‚å› æ­¤å’Œè§£åº”è¯¥å«åšï¼šæ¸²æŸ“ä¹‹å‰çš„ç»„ä»¶å’Œæ¸²æŸ“ä¹‹åçš„ç»„ä»¶åšè°ƒè§£ã€‚ä»–ä»¬å¦‚æœå±æ€§ä¸€è‡´ï¼Œè¡¨ç¤ºå’Œè§£æˆåŠŸäº†ï¼Œå³ä¸ä¼šåšæ”¹å˜ã€‚å¦‚æœä¸ä¸€è‡´ï¼Œè¡¨ç¤ºå’Œè§£ä¸æˆåŠŸï¼Œæœ€ç»ˆä¼šå°†æ”¹å˜ä½œç”¨åœ¨çœŸå®DOMä¸Šã€‚</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/React/" rel="tag"># React</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/10/11/introducing-the-react-profiler/" rel="next" title="introducing the react profiler">
                <i class="fa fa-chevron-left"></i> introducing the react profiler
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/10/30/articels/" rel="prev" title="articels">
                articels <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">luby xu</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">2</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">2</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#DOMçš„æ„å»º"><span class="nav-number">1.</span> <span class="nav-text">DOMçš„æ„å»º</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#ç†è§£Virtual-DOM"><span class="nav-number">2.</span> <span class="nav-text">ç†è§£Virtual DOM</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#è¾“å…¥input1å’Œinput2ï¼Œç‚¹å‡»addæŒ‰é’®"><span class="nav-number">2.1.</span> <span class="nav-text">è¾“å…¥input1å’Œinput2ï¼Œç‚¹å‡»addæŒ‰é’®</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ç‚¹å‡»addæŒ‰é’®ä¹‹åå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ"><span class="nav-number">2.2.</span> <span class="nav-text">ç‚¹å‡»addæŒ‰é’®ä¹‹åå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æ ‡æ³¨è„ç»„ä»¶"><span class="nav-number">2.3.</span> <span class="nav-text">æ ‡æ³¨è„ç»„ä»¶</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#éå†ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ"><span class="nav-number">2.4.</span> <span class="nav-text">éå†ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#renderç»„ä»¶â€”â€”æ›´æ–°Virtual-DOMï¼Œè°ƒç”¨diffç®—æ³•ï¼Œæœ€åæ›´æ–°åˆ°DOMä¸­ã€‚"><span class="nav-number">2.5.</span> <span class="nav-text">renderç»„ä»¶â€”â€”æ›´æ–°Virtual-DOMï¼Œè°ƒç”¨diffç®—æ³•ï¼Œæœ€åæ›´æ–°åˆ°DOMä¸­ã€‚</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æ¸²æŸ“çœŸå®DOM"><span class="nav-number">2.6.</span> <span class="nav-text">æ¸²æŸ“çœŸå®DOM</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#æ€»ç»“"><span class="nav-number">3.</span> <span class="nav-text">æ€»ç»“</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#ç‰›ç‰›ç†è§£"><span class="nav-number">4.</span> <span class="nav-text">ç‰›ç‰›ç†è§£</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">luby xu</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
